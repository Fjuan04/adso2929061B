<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>27-Challenge collisions</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
      body {
        padding: 0;
        margin: 0;
      }

      .canvas {
        background: url(Game/bgGame.png) repeat center / cover;

        animation: moverbg 120s linear infinite;
      }
      @keyframes moverbg {
        0% {
          background-position: 0%;
        }
        100% {
          background-position: 100%;
        }
      }

      
    </style>

</head>
<body class="js"> 
    <nav>
        <a href="../08-javascript/index.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill="#ffffff" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
        </a>
    </nav>
     <main>
        
          <canvas class="canvas" height="600" width="380" style="background-color: red; margin-block: 0;"></canvas>
        
    </main>


    <script>


      const lienzo = document.querySelector('.canvas')
      const lapiz  = lienzo.getContext('2d')
      const urls   = ['Game/dragonGame.png']
      const images = []
      const objects = []
      // Funcion para cargar imagenes

      

      function loadImage(urls, imgloaded, callback){
        let imgsloaded = 0

        urls.forEach((url)=> {
          let img = new Image()
          img.src = url

          img.onload = function(){
            imgloaded.push(img)
            imgsloaded++
            
            if(imgsloaded == urls.length){
              console.log('imagenes cargadas')
              callback()
            }
          }
        })
      }

      
      // Game

      const gameState = {
      
        gravedad : 0.6,
        gap : 150,
        espacio : 250,

      }
      // objetos (personajes)

      const bird = {
        x : 10,
        y : lienzo.height / 2 + 50,
        width : 85,
        height : 48,
        image : null,
        jump : -15,
        velY : 0
      }

      let pilar = {
        x : lienzo.width - 100,
        y : 0,
        width : 65,
        height : lienzo.height / 2,
        
      }
      function dibujar(){
          lapiz.clearRect(0, 0, lienzo.width, lienzo.height)
          lapiz.drawImage(bird.image, bird.x, bird.y, bird.width, bird.height)
          
          // bird.velY += gameState.gravedad
          // bird.y    += bird.velY
          // if(bird.y + bird.height > lienzo.height){
          //     bird.y = 1
          // }else if(bird.y < 0 ) bird.y = lienzo.height - 50
          lapiz.fillStyle = 'blue'
          lapiz.fillRect(pilar.x, pilar.y, pilar.width, pilar.height)
          lapiz.fillStyle = 'red'
          lapiz.fillRect(pilar.x, pilar.height + gameState.gap, pilar.width, pilar.height)



          
          requestAnimationFrame(dibujar)
      }

      

      document.addEventListener('keydown', (e)=>{
        if(e.code == 'Space'){
          bird.velY = bird.jump
        }
      })

      
    loadImage(urls, images, function(){
      bird.image = images[0]
      dibujar()
    })

    </script>
</body>
</html>
            